Not 100% solved but its enough to tell what it does.
